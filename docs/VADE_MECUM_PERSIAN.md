# آموزش استفاده از کتاب‌خانه‌ی cppcheckdata-shims

# بخش ۱:‌ معرفی

برنامه‌ی Cppcheck بعد از تحلیل ایستای کنونیکال خود به کاربر اجازه می‌دهد تا یک یا چند پلاگین را اجرا کند. این پلاگین‌ها خروجی XML برنامه را قبول می‌کنند و می‌توانند توسط این خروجی، تحلیل‌های خود را ارائه دهند. خروجی XML برنامه، انتزاع کمی دارد و نمی‌توان توسط آن، بسیاری از تحلیل‌های Path-Sensitive، Field-Sensitive و... را کامل انجام داد. این خروجی توسط ماژول CppcheckData که در فایل cppcheckdata.py قابل دسترسی‌ست را می‌توان «انتزاعی‌تر»‌ کرد. 

پس ما برین شدیم که یک کتاب‌خانه‌ی shim برای ماژول CppcheckData بسازیم. Shim معمولا به یک API اطلاق می‌شود که به یک API دیگر، امکانات جدیدی اضافه می‌کند. توجه کنید که Shim با Polyfill فرق دارد. Polyfill معمولا به کتاب‌خانه‌ای اطلاق می‌شود که امکانات مربوط به «سازگاری» به یک API دیگر اضافه می‌کند. اما Shim امکاناتی مربوط به فانکشنالیتی به یک API دیگر اضافه می‌کند.

کتاب‌خانه‌ی cppcheckdata-shims در پایتان نوشته شده‌است. این کتاب‌خانه، از اطلاعاتی که ماژول `cppcheckdata.py` در اختیار می‌گذارد استفاده می‌کند تا ماژول‌های زیر را اضافه کند:

- ماژول `ctrlflow_graph.py‍`: گراف کنترل جریان
- ماژول `ctrlflow_analysis.py‍‍`: تحلیل کنترل جریان
- ماژول `abstract_domains.py‍`: لاتیس‌های انتزاعی
- ماژول `dataflow_analysis.py`: تحلیل جریان داده
- ماژول ‍`abstract_interp.py‍‍`: تفسیر انتزاعی حساس به مسیر
- ماژول `callgraph.py‍`: گراف فراخوانی
- ماژول `interproc_analysis‍‍.py`: تحلیل بین‌تابعی (جهانی)
- ماژول ‍ `memory_abstraction.py‍`: تحلیل‌های مربوط به اشاره‌گرها و هیپ
- ماژول `constraint_engine.py‍`: حل کردن معادله‌های SAT
- ماژول `symbolic_exe.py‍‍`‌:‌ اجرای نمادین
- ماژول `qscore.py‍`: امتیاز به کیفیت برنامه
- ماژول `type_analysis.py‍`: تحلیل تایپ‌ها
- ماژول ‍‍`checkers.py`: اینترفیس کتاب‌خانه، چارچوب هم‌بستگی ماژول‌ها

وابستگی این ماژ‌ول‌ها به یک‌دیگر، از پایین به بالاست.

```text
cppcheckdata  ←  ctrlflow_graph  ←  dataflow_engine  ←  abstract_interp  ←  checkers
```

برای شروع استفاده از cppcheckdata-shims، می‌توانید به ریپازیتوری آن در گیت‌هاب رفته، و آن‌را کلون کنید:

```sh
$ git clone git@github.com:Chubek/cppcheckdata-shims.git
```

سپس، پیشنهاد می‌شود که یک محیط مجازی توسط ماژول venv بسازید، و کتاب‌خانه را روی آن نصب کنید:

```sh
$ python3 -m venv env
$ source ~/env/activate.<shell> # بر اساس پوسته‌ی خود
$ python3 setup.py install
```

توجه کنید که، کتاب‌خانه با بستری جدا به نام CASL عرضه می‌شود. CASL یا Cppcheck Addon Specification Language یک زبان دامنه‌محور ساخته شده بر اساس اصول زبان PQL می‌باشد. با CASL می‌توانید سمانتیک یک تحلیل‌گر ایستا را توصیف کرده، و با اجرای برنامه‌ی CASL روی این توصیفات، یک پلاگین که از کتاب‌خانه‌ی shim استفاده می‌کنید تحویل بگیرید:

```sh
$ casl UndefinedVariableUse.casl
```

