/* test_format_string.c
 * Expected: Taint from argv flows into printf format-string position.
 * CWE-134: Use of Externally-Controlled Format String
 */
#include <stdio.h>

int main(int argc, char *argv[])           /* argv is tainted (SOURCE) */
{
    if (argc < 2) {
        fprintf(stderr, "Usage: %s <name>\n", argv[0]);
        return 1;
    }

    /* BUG: user-controlled string used as format string */
    printf(argv[1]);                       /* SINK: CWE-134 */

    /* Also bad: syslog variant */
    /* syslog(LOG_INFO, argv[1]); */

    /* SAFE alternative: */
    /* printf("%s", argv[1]); */

    return 0;
}
